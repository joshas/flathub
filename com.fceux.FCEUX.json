{
	"app-id": "com.fceux.FCEUX",
	"runtime": "org.kde.Platform",
	"sdk": "org.kde.Sdk",
	"runtime-version": "5.15-23.08",
	"command": "fceux",
	"rename-desktop-file": "fceux.desktop",
	"finish-args": [
		"--device=all",
		"--filesystem=host:ro",
		"--share=ipc",
		"--socket=fallback-x11",
		"--socket=wayland",
		"--socket=pulseaudio",
		"--system-talk-name=org.freedesktop.UPower",
		"--talk-name=org.freedesktop.ScreenSaver",
		"--env=FCEUX_HOME=/var/config"
	],
	"cleanup": [
		"/include",
		"/lib/*.a",
		"/share/man",
		"/share/pixmaps",
		"/share/fceux/*.chm",
		"/share/fceux/*.dll"
	],
	"modules": [
		{
			"name": "minizip",
			"subdir": "contrib/minizip",
			"sources": [
				{
					"type": "archive",
					"url": "https://zlib.net/zlib-1.3.tar.xz",
					"sha256": "8a9ba2898e1d0d774eca6ba5b4627a11e5588ba85c8851336eb38de4683050a7"
				},
				{
					"type": "script",
					"dest": "contrib/minizip/",
					"dest-filename": "autogen.sh",
					"commands": [
						"autoreconf -ifv"
					]
				}
			]
		},
		{
			"name": "fceux",
			"buildsystem": "cmake",
			"config-opts": [
				"-DCMAKE_BUILD_TYPE=Release"
			],
			"build-commands": [
				"install -Dm644 appdata.xml /app/share/appdata/${FLATPAK_ID}.appdata.xml"
			],
			"post-install": [
				"sed -i 's,/usr/bin/fceux,/app/bin/fceux,' /app/share/applications/fceux.desktop",
				"desktop-file-edit --set-icon=$FLATPAK_ID /app/share/applications/fceux.desktop",
				"install -Dm644 /app/share/pixmaps/fceux1.png /app/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/TASEmulators/fceux/archive/refs/tags/v2.6.6.tar.gz",
					"sha256": "0320241d45c6d609f7aeb6f85fdd9019552047206b0864a7f9fddff15b004daa"
				},
				{
					"type": "file",
					"path": "appdata.xml"
				}
			]
		}
	]
}
